-- Creates table of with oid and size
CREATE VIEW OrderSize(oid,size)
AS SELECT Orders.order_id, COUNT(order_item_id)
    FROM Orders, Order_items
    WHERE Orders.order_id = Order_items.order_id;

-- Number of orders with more items than average
SELECT COUNT (*)
FROM Customers
WHERE customer_postal_code=:random_postal AND
      (SELECT COUNT(order_item_id)
       FROM Orders, Order_items
       WHERE Customers.customer_id = Orders.customer_id AND
             Orders.order_id = Order_items.order_id) >
            (SELECT AVG(size)
             FROM OrderSize);